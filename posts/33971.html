<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>爬虫实战-爬取广州大学课程表 | Notes|笔记站</title><link rel="icon" type="image/x-icon" href="/Arknight-notes/favicon.ico"><link rel="preload" as="font" crossorigin="anonymous" href="/Arknight-notes/font/Bender.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/Arknight-notes/font/BenderLight.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/Arknight-notes/font/JetBrainsMono-Regular.woff2"><link rel="stylesheet" href="/Arknight-notes/css/arknights.css"><style>@font-face {
  font-family: Bender;
  src: local('Bender'), url("/Arknight-notes/font/Bender.ttf"), url("/Arknight-notes/font/Bender.otf");
}
@font-face {
  font-family: BenderLight;
  src: local('BenderLight'), url("/Arknight-notes/font/BenderLight.ttf");
}
@font-face {
  font-family: 'JetBrains Mono';
  src: local('JetBrains Mono'), url('/Arknight-notes/font/JetBrainsMono-Regular.woff2') format('woff2');
}
</style><script>var config = {"root":"/Arknight-notes/","code_fold":90,"search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy"}}</script><link type="text/css" rel="stylesheet" href="/Arknight-notes/lib/encrypt/hbe.style.css"><script src="/Arknight-notes/js/gitalk.js"></script><script src="//unpkg.com/mermaid@10.5.0/dist/mermaid.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script><script>MathJax.Hub.Config({
 menuSettings: {
   zoom: "None"
 },
 showMathMenu: false,
 jax: ["input/TeX","output/CommonHTML"],
 extensions: ["tex2jax.js"],
 TeX: {
   extensions: ["AMSmath.js","AMSsymbols.js"],
   equationNumbers: {
     autoNumber: "AMS"
   }
 },
 tex2jax: {
   inlineMath: [["\\(", "\\)"]],
   displayMath: [["\\[", "\\]"]]
 }
});</script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/Arknight-notes/lib/fontawesome/css/all.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light')
 document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark')
 document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/Arknight-notes/font/BenderLight.woff2") format('woff2');
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/Arknight-notes/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
 --dark-background: url('https://pic2.zhimg.com/v2-6269d74b4dafe14781d03790e5a86b21_r.jpg');
 --light-background: url('https://pic1.zhimg.com/v2-233b64b583642fc4a6d77e69ced33150_r.jpg');
 --theme-encrypt-confirm: 'confirm'
}</style><script defer src="/Arknight-notes/js/arknights.js"></script><script defer src="/Arknight-notes/js/search.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script async src="/Arknight-notes/js/gitalk.js"></script><script defer type="module">import mermaid from '//unpkg.com/mermaid@10.5.0/dist/mermaid.esm.mjs';
window.mermaid = mermaid;
code.paintMermaid();
</script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script><script>MathJax.Hub.Config({
  menuSettings: {
    zoom: "None"
  },
  showMathMenu: false,
  jax: ["input/TeX","output/CommonHTML"],
  extensions: ["tex2jax.js"],
  TeX: {
    extensions: ["AMSmath.js","AMSsymbols.js"],
    equationNumbers: {
      autoNumber: "AMS"
    }
  },
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]]
  }
});
</script><script async src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script async src="/Arknight-notes/lib/encrypt/hbe.js"></script><script async src="/Arknight-notes/js/pjax.js"></script><script class="pjax-js">reset= () => {gitalk = new Gitalk({
 clientID: 'Ov23ct13Fb0b67x23wnT',
 clientSecret: 'f18ce69dd545e3c0f5e2456afde9c756fe8a254a',
 repo: 'Arknight-notes',
 owner: 'Zhongye1',
 admin: ['Zhongye1'],
 distractionFreeMode: false,
 id: location.pathname
});
if (document.querySelector("#gitalk")) gitalk.render("gitalk");document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.busuanzi'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);document.addEventListener('pjax:success', _ => bszCaller.fetch(
 "//busuanzi.ibruce.info/busuanzi?jsonpCallback=BusuanziCallback", a => {
  bszTag.texts(a),
  bszTag.shows()
}));reset()})</script><script class="pjax-js">reset= () => {gitalk = new Gitalk({
 clientID: 'Ov23ct13Fb0b67x23wnT',
 clientSecret: 'f18ce69dd545e3c0f5e2456afde9c756fe8a254a',
 repo: 'Arknight-notes',
 owner: 'Zhongye1',
 admin: ['Zhongye1'],
 distractionFreeMode: false,
 id: location.pathname
});
if (document.querySelector("#gitalk")) gitalk.render("gitalk");document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/Arknight-notes/rss.xml" title="Notes|笔记站" type="application/atom+xml">
<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><nav><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup" tabindex="0"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/Arknight-notes/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/Arknight-notes/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/Arknight-notes/about/"><span class="navItemTitle">About</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>爬虫实战-爬取广州大学课程表</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2025-03-01T06:55:48.000Z" id="date"> 2025-03-01</time></div></span><br><span>Last Update: <div class="control"><time datetime="2025-04-03T06:22:53.773Z" id="updated"> 2025-04-03</time></div></span><br><span id="busuanzi_container_page_pv">Page View: <span class="control" id="busuanzi_value_page_pv">loading...</span></span></div></div><hr><div id="post-content"><p><em>大二上在学python，所以想要用python实现一下课表爬取。</em></p>
<p><em>（虽然python开课爬虫不怎么讲的都</em></p>
<p><em>本文仅供学习使用。</em> </p>
<h1 id="广州大学课程信息查询脚本"><a href="#广州大学课程信息查询脚本" class="headerlink" title="广州大学课程信息查询脚本"></a>广州大学课程信息查询脚本</h1><h2 id="1-概述"><a href="#1-概述" class="headerlink" title="1. 概述"></a>1. 概述</h2><p>本脚本用于自动化登录广州大学教务系统，获取当前学期课程信息，主要功能包括：</p>
<ul>
<li>通过浏览器自动化（Selenium）模拟用户登录，绕过滑块验证。</li>
<li>使用获取的Cookie通过<code>requests</code>库发送API请求，获取课程数据。</li>
<li>结构化处理课程信息，并导出为JSON和CSV格式文件。</li>
</ul>
<hr>
<h2 id="2-环境依赖"><a href="#2-环境依赖" class="headerlink" title="2. 环境依赖"></a>2. 环境依赖</h2><h3 id="2-1-运行环境"><a href="#2-1-运行环境" class="headerlink" title="2.1 运行环境"></a>2.1 运行环境</h3><ul>
<li><p><strong>Python 3.7+</strong></p>
</li>
<li><p>依赖库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pip install selenium requests pandas<br></code></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="2-2-配置"><a href="#2-2-配置" class="headerlink" title="2.2 配置"></a>2.2 配置</h3><ul>
<li>手动输入学号密码（脚本运行时会提示），查询时段的配置请求参数</li>
<li>后期待完善（</li>
</ul>
<hr>
<h2 id="3-功能模块"><a href="#3-功能模块" class="headerlink" title="3. 功能模块"></a>3. 功能模块</h2><h3 id="3-1-登录模块"><a href="#3-1-登录模块" class="headerlink" title="3.1 登录模块"></a>3.1 登录模块</h3><h4 id="功能描述"><a href="#功能描述" class="headerlink" title="功能描述"></a>功能描述</h4><ul>
<li>通过Selenium启动浏览器，访问教务系统登录页面。</li>
<li>自动填充学号、密码，并绕过滑块验证。</li>
<li>判断登录状态，成功后保存Cookie供后续请求使用。</li>
</ul>
<h4 id="输入参数"><a href="#输入参数" class="headerlink" title="输入参数"></a>输入参数</h4><ul>
<li>学号（<code>login_username</code>）</li>
<li>密码（<code>login_password</code>）</li>
</ul>
<h4 id="关键逻辑"><a href="#关键逻辑" class="headerlink" title="关键逻辑"></a>关键逻辑</h4><ul>
<li><strong>浏览器配置</strong>：禁用自动化检测标志（<code>excludeSwitches: ['enable-automation']</code>），防止被识别为爬虫。</li>
<li><strong>滑块验证绕过</strong>：通过执行JavaScript代码<code>navigator.webdriver = false</code>。</li>
<li><strong>登录状态检查</strong>：通过页面元素或关键词（如<code>登录成功</code>）判断是否登录成功。</li>
</ul>
<hr>
<h3 id="3-2-课程数据获取模块"><a href="#3-2-课程数据获取模块" class="headerlink" title="3.2 课程数据获取模块"></a>3.2 课程数据获取模块</h3><h4 id="功能描述-1"><a href="#功能描述-1" class="headerlink" title="功能描述"></a>功能描述</h4><ul>
<li><p>使用<code>requests</code>库发送POST请求，携带登录后的Cookie和参数，获取课程数据。</p>
</li>
<li><p>数据接口：<code>http://jwxt.gzhu.edu.cn/jwglxt/kbcx/xskbcx_cxXsgrkb.html</code>（F12大法</p>
<p class='item-img' data-src='https://free-img.400040.xyz/4/2025/03/01/67c2b8ec8a7cc.png'><img src="https://free-img.400040.xyz/4/2025/03/01/67c2b8ec8a7cc.png" alt=""></p>
<p class='item-img' data-src='https://free-img.400040.xyz/4/2025/03/01/67c2b96c96a63.png'><img src="https://free-img.400040.xyz/4/2025/03/01/67c2b96c96a63.png" alt=""></p>
</li>
</ul>
<h4 id="请求参数"><a href="#请求参数" class="headerlink" title="请求参数"></a>请求参数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">data = {<br>    <span class="hljs-string">"xnm"</span>: <span class="hljs-string">"2024"</span>,     <span class="hljs-comment"># 学年（2024表示2023-2024学年）</span><br>    <span class="hljs-string">"kzlx"</span>: <span class="hljs-string">"ck"</span>,      <span class="hljs-comment"># 查询类型（ck=查看）</span><br>    <span class="hljs-string">"xsdm"</span>: <span class="hljs-string">""</span>,        <span class="hljs-comment"># 学生代码（留空）</span><br>    <span class="hljs-string">"xqm"</span>: <span class="hljs-string">"3"</span>         <span class="hljs-comment"># 学期码（3表示秋季学期）</span><br>}<br></code></pre></td></tr></table></figure>
<h4 id="请求头（Headers）"><a href="#请求头（Headers）" class="headerlink" title="请求头（Headers）"></a>请求头（Headers）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">headers = {<br>    <span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"Mozilla/5.0 ..."</span>,  <span class="hljs-comment"># 模拟浏览器请求</span><br>    <span class="hljs-string">"Referer"</span>: <span class="hljs-string">"http://jwxt.gzhu.edu.cn/..."</span>,  <span class="hljs-comment"># 来源页面</span><br>    <span class="hljs-string">"X-Requested-With"</span>: <span class="hljs-string">"XMLHttpRequest"</span>       <span class="hljs-comment"># 标识AJAX请求</span><br>}<br></code></pre></td></tr></table></figure>
<hr>
<h3 id="3-3-数据处理与导出模块"><a href="#3-3-数据处理与导出模块" class="headerlink" title="3.3 数据处理与导出模块"></a>3.3 数据处理与导出模块</h3><h4 id="功能描述-2"><a href="#功能描述-2" class="headerlink" title="功能描述"></a>功能描述</h4><ol>
<li><p><strong>JSON数据处理</strong></p>
<ul>
<li>从原始响应中提取关键字段（如课程名称<code>kcmc</code>、教室<code>cdmc</code>、节次<code>jc</code>）。</li>
<li>映射星期代码（<code>xqjmcMap</code>）为中文（如<code>1 → 周一</code>）。</li>
<li>保存结构化的JSON文件（<code>extracted_courses.json</code>）。</li>
</ul>
</li>
<li><p><strong>CSV导出</strong></p>
<ul>
<li><p>使用<code>pandas</code>将JSON数据转换为表格形式。</p>
</li>
<li><p>添加中文表头（如“课程名称”、“教室”）。</p>
</li>
<li><p>导出为CSV文件（<code>courses.csv</code>），兼容Excel打开。</p>
<p class='item-img' data-src='https://free-img.400040.xyz/4/2025/03/01/67c2b36edf98c.png'><img src="https://free-img.400040.xyz/4/2025/03/01/67c2b36edf98c.png" style="zoom:50%;"></p>
</li>
</ul>
</li>
</ol>
<h4 id="字段映射表"><a href="#字段映射表" class="headerlink" title="字段映射表"></a>字段映射表</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">原始字段</th>
<th style="text-align:center">中文表头</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>kcmc</code></td>
<td style="text-align:center">课程名称</td>
<td style="text-align:center">课程全称</td>
</tr>
<tr>
<td style="text-align:center"><code>cdmc</code></td>
<td style="text-align:center">教室</td>
<td style="text-align:center">上课地点</td>
</tr>
<tr>
<td style="text-align:center"><code>jc</code></td>
<td style="text-align:center">节数</td>
<td style="text-align:center">课程节次（如1-2节）</td>
</tr>
<tr>
<td style="text-align:center"><code>xqjmc</code></td>
<td style="text-align:center">日期</td>
<td style="text-align:center">星期几（周一至日）</td>
</tr>
<tr>
<td style="text-align:center"><code>kcxszc</code></td>
<td style="text-align:center">课时安排</td>
<td style="text-align:center">周次范围（如1-16周）</td>
</tr>
</tbody>
</table>
</div>
<hr>
<h2 id="4-代码详解"><a href="#4-代码详解" class="headerlink" title="4. 代码详解"></a>4. 代码详解</h2><h3 id="4-1-登录流程"><a href="#4-1-登录流程" class="headerlink" title="4.1 登录流程"></a>4.1 登录流程</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 防止打开浏览器后闪退</span><br>options = webdriver.ChromeOptions()<br>options.add_experimental_option(<span class="hljs-string">'detach'</span>, <span class="hljs-literal">True</span>)<br><span class="hljs-comment"># options.add_argument('--headless')  # 无头模式</span><br><br><span class="hljs-comment"># 开发者模式，防止被各大网站识别出来使用了Selenium</span><br>options.add_experimental_option(<span class="hljs-string">'excludeSwitches'</span>, [<span class="hljs-string">'enable-automation'</span>])<br><br><span class="hljs-comment"># 启动浏览器</span><br>browser = webdriver.Chrome(options=options)<br>browser.get(login_url)<br><br><span class="hljs-comment"># 绕过滑块验证</span><br>browser.execute_script(<span class="hljs-string">'Object.defineProperties(navigator,{webdriver:{get:()=&gt;false}})'</span>)<br><br><span class="hljs-comment"># 查找用户名和密码输入框所在元素</span><br>username_input = browser.find_element(By.ID, <span class="hljs-string">'un'</span>)<br>username_input.click()<br>username_input.send_keys(login_username)<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 等待响应</span><br>time.sleep(<span class="hljs-number">2</span>)<br><br><span class="hljs-comment"># 输入信息模拟登录</span><br>password_input = browser.find_element(By.XPATH, <span class="hljs-string">"//input[@name='pd']"</span>)<br>password_input.click()<br>password_input.send_keys(login_password)<br><br>login_button = browser.find_element(By.ID, <span class="hljs-string">'index_login_btn'</span>)<br>login_button.click()<br><br>time.sleep(<span class="hljs-number">5</span>)<br><br><span class="hljs-comment"># 检查登录是否成功</span><br><span class="hljs-keyword">if</span> <span class="hljs-string">'登录成功'</span> <span class="hljs-keyword">in</span> browser.page_source <span class="hljs-keyword">or</span> <span class="hljs-string">'index_login_btn'</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> browser.page_source:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">"登录成功"</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">"登录失败"</span>)<br><br>cookies = browser.get_cookies()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">"Cookies:"</span>, cookies)<br><br>cookie_dict = {cookie[<span class="hljs-string">'name'</span>]: cookie[<span class="hljs-string">'value'</span>] <span class="hljs-keyword">for</span> cookie <span class="hljs-keyword">in</span> cookies}<br><br><span class="hljs-comment"># 关闭浏览器</span><br>browser.quit()<br></code></pre></td></tr></table></figure>
<h3 id="4-2-数据请求"><a href="#4-2-数据请求" class="headerlink" title="4.2 数据请求"></a>4.2 数据请求</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-comment"># 请求头</span><br>headers = {<br>    <span class="hljs-string">"Accept"</span>: <span class="hljs-string">"*/*"</span>,<br>    <span class="hljs-string">"Accept-Encoding"</span>: <span class="hljs-string">"gzip, deflate"</span>,<br>    <span class="hljs-string">"Accept-Language"</span>: <span class="hljs-string">"zh-CN,zh;q=0.9"</span>,<br>    <span class="hljs-string">"Connection"</span>: <span class="hljs-string">"keep-alive"</span>,<br>    <span class="hljs-string">"Content-Length"</span>: <span class="hljs-string">"28"</span>,<br>    <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/x-www-form-urlencoded;charset=UTF-8"</span>,<br>    <span class="hljs-string">"Host"</span>: <span class="hljs-string">"jwxt.gzhu.edu.cn"</span>,<br>    <span class="hljs-string">"Origin"</span>: <span class="hljs-string">"http://jwxt.gzhu.edu.cn"</span>,<br>    <span class="hljs-string">"Referer"</span>: <span class="hljs-string">"http://jwxt.gzhu.edu.cn/jwglxt/kbcx/xskbcx_cxXskbcxIndex.html?gnmkdm=███████&amp;layout=default"</span>,<br>    <span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"Mozilla/███████ (Windows NT ███████; Win64; x64) AppleWebKit/███████ (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36"</span>,<br>    <span class="hljs-string">"X-Requested-With"</span>: <span class="hljs-string">"XMLHttpRequest"</span><br>}<br><br><span class="hljs-comment"># 表单数据(学年和学期)</span><br>data = {<br>    <span class="hljs-string">"xnm"</span>: <span class="hljs-string">"2024"</span>,<br>    <span class="hljs-string">"kzlx"</span>: <span class="hljs-string">"ck"</span>,<br>    <span class="hljs-string">"xsdm"</span>: <span class="hljs-string">""</span>,<br>    <span class="hljs-string">"xqm"</span>: <span class="hljs-string">"3"</span><br>}<br><br>session = requests.Session()<br><br><span class="hljs-keyword">for</span> name, value <span class="hljs-keyword">in</span> cookie_dict.items():<br>    session.cookies.<span class="hljs-built_in">set</span>(name, value)<br><br><span class="hljs-comment"># POST请求</span><br>response = session.post(target_url, headers=headers, data=data)<br><br><span class="hljs-comment"># 检查请求是否成功</span><br><span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>    <span class="hljs-keyword">try</span>:<br>        response_data = response.json()<br>        formatted_data = json.dumps(response_data, indent=<span class="hljs-number">4</span>, ensure_ascii=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'course_schedule.json'</span>, <span class="hljs-string">'w'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> file:<br>            file.write(formatted_data)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">"返回的数据已经保存至course_schedule.json"</span>)<br><br>    <span class="hljs-keyword">except</span> ValueError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">"无法解析JSON数据"</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"请求失败，状态码: <span class="hljs-subst">{response.status_code}</span>"</span>)<br></code></pre></td></tr></table></figure>
<h3 id="4-3-JSON数据处理"><a href="#4-3-JSON数据处理" class="headerlink" title="4.3 JSON数据处理"></a>4.3 JSON数据处理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 提取字段并重构数据</span><br>courses = []<br><span class="hljs-keyword">for</span> course <span class="hljs-keyword">in</span> data[<span class="hljs-string">'kbList'</span>]:<br>    course_info = {<br>        <span class="hljs-string">"课程名称"</span>: course.get(<span class="hljs-string">'kcmc'</span>, <span class="hljs-string">''</span>),<br>        <span class="hljs-string">"教室"</span>: course.get(<span class="hljs-string">'cdmc'</span>, <span class="hljs-string">''</span>),<br>        <span class="hljs-comment"># ... 其他字段映射</span><br>    }<br>    courses.append(course_info)<br></code></pre></td></tr></table></figure>
<h3 id="4-4-CSV导出逻辑"><a href="#4-4-CSV导出逻辑" class="headerlink" title="4.4 CSV导出逻辑"></a>4.4 CSV导出逻辑</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 使用pandas转换并导出</span><br>df = pd.DataFrame(courses)<br>df.to_csv(<span class="hljs-string">'courses.csv'</span>, index=<span class="hljs-literal">False</span>, encoding=<span class="hljs-string">'utf-8-sig'</span>)  <span class="hljs-comment"># 兼容Excel中文编码</span><br></code></pre></td></tr></table></figure>
<h2 id=""><a href="#" class="headerlink" title=" "></a> </h2><ol>
<li><p><strong>滑块验证更新</strong>：若教务系统更新滑块验证逻辑，需调整JavaScript绕过代码。</p>
</li>
<li><p><strong>接口稳定性</strong>：课程查询接口（<code>xskbcx_cxXsgrkb.html</code>）若变更URL，需同步更新。</p>
</li>
</ol>
<hr>
<h2 id="6-输出示例"><a href="#6-输出示例" class="headerlink" title="6. 输出示例"></a>6. 输出示例</h2><h3 id="6-1-JSON文件（extracted-courses-json）"><a href="#6-1-JSON文件（extracted-courses-json）" class="headerlink" title="6.1 JSON文件（extracted_courses.json）"></a>6.1 JSON文件（extracted_courses.json）</h3><p>和谐了部分隐私信息（</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">{</span><br>            <span class="hljs-attr">"bklxdjmc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"无"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"cd_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1015170"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"cdlbmc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"多媒体"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"cdmc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"███████517"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"cxbj"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"cxbjmc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"无"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"二○二四年十一月十五日"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"dateDigit"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024年11月15日"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"dateDigitSeparator"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024-11-15"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"day"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"15"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"jc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"3-4节"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"jcor"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"3-4"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"jcs"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"3-4"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"jgh_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"104119"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"jgpxzd"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"jxb_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1850E3A697E512CAE06███████ACA210"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"jxbmc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"(2024-2025-1)-216███████-01"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"jxbsftkbj"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"jxbzc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"███████"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"kcbj"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"主修"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"kch"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"███████"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"kch_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"███████"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"kclb"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"专业课程平台"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"kcmc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"常微分方程1"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"kcxszc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"理论:48"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"kcxz"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"专选"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"kczxs"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"48"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"khfsmc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"考试"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"kkzt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"lh"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"███████楼"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"listnav"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"false"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"localeKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"zh_CN"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"month"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"11"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"oldjc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"12"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"oldzc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"65280"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"pageTotal"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"pageable"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"pkbj"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"px"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"qqqh"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"无"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"queryModel"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><br>                <span class="hljs-attr">"currentPage"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"currentResult"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"entityOrField"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"limit"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"offset"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"pageNo"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"pageSize"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"showCount"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"sorts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"totalCount"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"totalPage"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"totalResult"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><br>            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"rangeable"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"rk"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"12"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"rsdzjs"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"sfjf"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"skfsmc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"无"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"sxbj"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"totalResult"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"userModel"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><br>                <span class="hljs-attr">"monitor"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"roleCount"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"roleKeys"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"roleValues"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">"usable"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><br>            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"xf"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"3"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"xkbz"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"无"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"xm"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"███████"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"xnm"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"xqdm"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"xqh1"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1,2,"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"xqh_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"xqj"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"xqjmc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"星期一"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"xqm"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"3"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"xqmc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"███████"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"xsdm"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"01"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"xslxbj"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"*"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"year"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"zcd"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"9-███████周"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"zcmc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"███████"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"zfjmc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"主讲"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"zhxs"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"3"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"zxs"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"48"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"zxxx"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"无"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"zyfxmc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"███████"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"zyhxkcbj"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"否"</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">"zzrl"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"███████"</span><br>        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br></code></pre></td></tr></table></figure>
<h3 id="6-2-CSV文件（courses-csv）"><a href="#6-2-CSV文件（courses-csv）" class="headerlink" title="6.2 CSV文件（courses.csv）"></a>6.2 CSV文件（courses.csv）</h3><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">课程名称</th>
<th style="text-align:center">教室</th>
<th style="text-align:center">节数</th>
<th style="text-align:center">日期</th>
<th style="text-align:center">课时安排</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">常微分方程1</td>
<td style="text-align:center">███████</td>
<td style="text-align:center">3-4</td>
<td style="text-align:center">周一</td>
<td style="text-align:center">1-16周</td>
</tr>
</tbody>
</table>
</div>
<p class='item-img' data-src='https://free-img.400040.xyz/4/2025/03/01/67c2b36edf98c.png'><img src="https://free-img.400040.xyz/4/2025/03/01/67c2b36edf98c.png" style="zoom:50%;"></p>
<h2 id="7-todo"><a href="#7-todo" class="headerlink" title="7. todo"></a>7. todo</h2><ol>
<li><strong>可视化界面</strong>：集成<code>tkinter</code>或Web框架（如Flask）提供GUI操作。</li>
<li><strong>全校课表爬虫</strong></li>
</ol>
<p>�**</p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/Arknight-notes/posts/20561.html">← Next 2024一些笔记（概率论）</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/Arknight-notes/posts/33014.html">关于WSL Docker清理 Prev →</a></div></div></div><div id="comments"><div id="gitalk"></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧ </a><a class="i-index" id="to-index" href="#toc-div" title="To Catalog">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/Arknight-notes/" id="logo"><img src="https://pic4.zhimg.com/80/v2-d9884f32711e19e80979eac58e943897_720w.webp" alt="Logo" style="margin:20;border-radius:0;"></a><h1 id="Dr"><a href="zhongye">柊野</a></h1><div id="description"><p></p></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B9%BF%E5%B7%9E%E5%A4%A7%E5%AD%A6%E8%AF%BE%E7%A8%8B%E4%BF%A1%E6%81%AF%E6%9F%A5%E8%AF%A2%E8%84%9A%E6%9C%AC"><span class="toc-number">1.</span> <span class="toc-text">广州大学课程信息查询脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text">1. 概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%8E%AF%E5%A2%83%E4%BE%9D%E8%B5%96"><span class="toc-number">1.2.</span> <span class="toc-text">2. 环境依赖</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 运行环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97"><span class="toc-number">1.3.</span> <span class="toc-text">3. 功能模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E7%99%BB%E5%BD%95%E6%A8%A1%E5%9D%97"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 登录模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%8F%8F%E8%BF%B0"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">功能描述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E5%8F%82%E6%95%B0"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">输入参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E9%80%BB%E8%BE%91"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">关键逻辑</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E8%AF%BE%E7%A8%8B%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96%E6%A8%A1%E5%9D%97"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 课程数据获取模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%8F%8F%E8%BF%B0-1"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">功能描述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">请求参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%A4%B4%EF%BC%88Headers%EF%BC%89"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">请求头（Headers）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B8%8E%E5%AF%BC%E5%87%BA%E6%A8%A1%E5%9D%97"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3 数据处理与导出模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%8F%8F%E8%BF%B0-2"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">功能描述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E6%AE%B5%E6%98%A0%E5%B0%84%E8%A1%A8"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">字段映射表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.4.</span> <span class="toc-text">4. 代码详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E7%99%BB%E5%BD%95%E6%B5%81%E7%A8%8B"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 登录流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 数据请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-JSON%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 JSON数据处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-CSV%E5%AF%BC%E5%87%BA%E9%80%BB%E8%BE%91"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.4 CSV导出逻辑</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.5.</span> <span class="toc-text"> </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E8%BE%93%E5%87%BA%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.6.</span> <span class="toc-text">6. 输出示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-JSON%E6%96%87%E4%BB%B6%EF%BC%88extracted-courses-json%EF%BC%89"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 JSON文件（extracted_courses.json）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-CSV%E6%96%87%E4%BB%B6%EF%BC%88courses-csv%EF%BC%89"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 CSV文件（courses.csv）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-todo"><span class="toc-number">1.7.</span> <span class="toc-text">7. todo</span></a></li></ol></li></ol></div></div><footer><nobr><span class="icp-title">GZHU</span><span class="icp-content">193001-0001</span></nobr><br><nobr><span class="icp-title">OUTPOST</span><span class="icp-content">169-2025-0331</span></nobr><br><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr> by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas></body></html>